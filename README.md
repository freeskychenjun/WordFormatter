# 报告自动排版工具_JXSLY (Word-Formatter-Pro)

一款桌面应用程序，可将水利工程规划设计报告一键转换为符合规定的专业文档，实现排版工作自动化。


## 主要功能

*   **基于公文标准**：软件的默认参数遵循公司规范标准设置。
*   **一键式操作**：导入文件或文本，点击按钮即可完成排版。

### 智能识别与处理

*   **图片、表格标题定位**：自动查找并格式化居中图片和表格附近的"图X"、"表X"标题。

### 兼容性与易用性

*   **批量处理**：支持拖入单个文件、多个文件或整个文件夹。
*   **安全无损**：所有操作均在副本上进行，原始文件不会被修改。
*   **参数自定义**：所有核心参数（页边距、字体、字号、行距等）均可在界面调整。配置方案可保存和加载。


## 如何使用

### 方式一：直接运行程序 (推荐)

1.  **环境依赖**：确保电脑上已安装 **Microsoft Office** 或 **WPS Office**。
2.  **运行**：双击 `.exe` 文件即可，无需安装。

### 方式二：从源码运行

1.  **环境依赖**：
    *   已安装 Python 3.x。
    *   已安装 **Microsoft Office** 或 **WPS Office**。

2.  **安装所需库**：
    ```bash
    pip install -r requirements.txt
    ```
3.  **运行程序**：
    ```bash
    python wfp.py 
    ```

## 操作流程

1.  **选择模式**：选择单个文件或文件夹进行排版，或选择批量处理模式进行文件夹内所有文件批量处理。
2.  **添加内容**：
    *   **文件模式**：点击"添加文件"或"添加文件夹"导入。
3.  **调整参数 (可选)**：在"参数设置"区进行调整，或加载已保存的配置方案。
4.  **开始排版**：点击"开始排版"按钮。
5.  **选择输出位置**：根据提示选择处理后文件的保存位置。
6.  **完成**：处理完毕后会弹出成功提示。

## 常见问题 (FAQ)

**Q1：为什么排版后的字体显示不正确，或者不是公文标准字体（如方正小标宋）？**

A：这是因为您的电脑中缺少公文规范所要求的字体文件（例如：方正小标宋、方正仿宋_GBK 等）。出于版权原因，本工具无法捆绑这些字体。请您自行从正规渠道获取并安装这些字体至您的 Windows 系统字体文件夹中，完成后再重新运行本工具即可。

**Q2：我使用的是 32 位 Windows 系统，为什么无法运行 .exe 文件？**

A：本项目在 Releases 页面提供的 `.exe` 可执行文件是为 **64 位 (x64) Windows 7 及以上系统** 打包的。32 位系统无法直接运行。


**Q4：点击"开始排版"后程序报错、卡住或无响应？**

A：请务必确认您的电脑已正确安装 **Microsoft Office** 或 **WPS Office**。本工具依赖于它们的 COM 接口进行 Word 文档的读写和转换。如果未安装，程序将无法工作。如果程序运行结束后，界面卡死、无法打开WPS或Word文档，可以在任务管理器中终止本程序以及WPS、Word程序后，再重新打开程序或相关文档。


